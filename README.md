# 来找茬 - 设计校对工具

一个 Chrome 浏览器插件，用于辅助设计与研发在页面级别完成设计偏差确认的工具。

## 功能特性

- ✅ 支持在浏览器中直接选中页面 DOM 元素作为校对对象
- ✅ 支持为选中 DOM 绑定对应的 Figma 设计链接作为语义参照
- ✅ 基于 DOM / CSS 差异，在页面内生成覆盖标注
- ✅ 支持在页面上下文中完成人工确认是否为设计偏差
- ✅ 将被确认的问题以结构化表格形式输出（CSV / Markdown）

## 安装方法

### 1. 生成图标（可选但推荐）

插件需要图标文件才能正常显示。你可以：

**方法一：使用提供的工具生成**
1. 在浏览器中打开 `icons/create-icons.html`
2. 点击各个"下载"按钮，将图标保存到 `icons/` 目录

**方法二：手动创建**
在 `icons/` 目录下创建以下文件：
- `icon16.png` (16x16 像素)
- `icon48.png` (48x48 像素)
- `icon128.png` (128x128 像素)

如果暂时没有图标，插件仍然可以运行，但会在 Chrome 扩展管理页面显示警告。

### 2. 安装插件

1. 打开 Chrome 浏览器，进入扩展程序管理页面：`chrome://extensions/`
2. 开启右上角的"开发者模式"
3. 点击"加载已解压的扩展程序"
4. 选择本插件的目录（`来找茬` 文件夹）
5. 插件安装完成后，浏览器工具栏会显示插件图标

## 使用说明

### 1. 开启选择模式

1. 打开需要校对的网页
2. 点击浏览器工具栏中的插件图标，打开插件面板
3. 点击"开启选择模式"按钮
4. 鼠标移动到页面上，会看到元素被高亮显示

### 2. 选中元素并绑定 Figma 链接

1. 点击需要校对的 DOM 元素
2. 元素被选中后，选择模式会自动关闭
3. 在插件面板中，粘贴对应的 Figma Frame / Node 链接
4. 点击"保存"按钮

### 3. 检测差异

1. 在插件面板中点击"检测差异"按钮
2. 系统会对比当前样式与首次选中时记录的基准样式
3. 如果发现差异，会在页面上显示覆盖标注

### 4. 查看和确认差异

1. 将鼠标悬停在页面上的标注区域，可以看到差异信息
2. 点击标注区域，会弹出确认浮层
3. 选择确认状态：
   - **未确认**：暂时不处理
   - **接受差异**：差异是可接受的
   - **需要修复**：差异需要修复
4. 可以填写备注信息
5. 点击对应状态按钮完成确认

### 5. 导出结果

1. 在插件面板的"需要修复的问题"区域，会显示所有状态为"需要修复"的差异项
2. 点击"导出 CSV"或"导出 Markdown"按钮
3. 文件会自动下载到本地

## 检测的差异类型

插件会检测以下 CSS 属性的变化：

- width / height（宽度/高度）
- margin / padding（外边距/内边距）
- font-size / font-weight / color（字体大小/粗细/颜色）
- position / z-index（定位/层级）

## 数据结构

差异项的数据结构：

```typescript
DiffItem {
  diffId: string          // 差异项唯一标识
  selector: string        // DOM 选择器
  figmaLink: string       // Figma 设计链接
  diffType: string        // 差异类型
  baselineValue: string   // 基准值
  currentValue: string    // 当前值
  status: 'pending' | 'accepted' | 'fix_required'  // 确认状态
  note?: string          // 备注
}
```

## 注意事项

- 插件使用 Chrome Storage API 存储数据，数据保存在本地
- 刷新页面后，覆盖标注会重新显示（如果元素位置发生变化，需要重新检测差异）
- 建议在结构稳定的页面上使用，避免频繁的 DOM 变化影响校对结果

## 技术栈

- Chrome Extension Manifest V3
- Vanilla JavaScript
- Chrome Storage API
- CSS Overlay

## 开发说明

### 文件结构

```
来找茬/
├── manifest.json       # 插件配置文件
├── popup.html          # 插件弹出窗口 HTML
├── popup.js            # 弹出窗口逻辑
├── popup.css           # 弹出窗口样式
├── content.js          # 内容脚本（页面交互）
├── content.css         # 内容脚本样式
├── background.js       # 后台服务
├── icons/              # 图标文件目录
└── README.md           # 说明文档
```

### 本地开发

1. 修改代码后，在 `chrome://extensions/` 页面点击插件的"重新加载"按钮
2. 刷新目标网页以应用更改

## 后续可拓展方向

- 引入鉴权与后端服务
- 多人协作与确认复用
- 规则分级与自动分类
- 截图 diff 作为辅助裁决手段
